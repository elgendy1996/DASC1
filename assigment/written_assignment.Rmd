---
title: "written_assignment"
author: "Mohamed Ismael, Mohamed Elgendy"
date: "2022-09-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
  library(tidyverse)
```

# Tidy

## Import
```{r}
  qog_std <- read.csv("dataset/qog_std_cs_jan22.csv")
```

## Friendly variable names

These are the variables we would like to focus on.

liberal democracy index (vdem_libdem)

political corruption (vdem_corr)

Freedom of Expression and Belief (fh_feb)

Equal opportunity (bti_eo)




```{r}
democracy_effect <- qog_std %>%
  select(
    vdem_libdem,
    vdem_corr,
    bti_eo,
    fh_feb,
  )%>%
  rename(
    liberal_democracy = vdem_libdem,
    political_corr = vdem_corr,
    equal_oppor = bti_eo,
    freedom_of_speech = fh_feb,
  ) %>% drop_na(liberal_democracy, 
                political_corr, 
                equal_oppor, 
                freedom_of_speech
  )
    
```
We filtered the dataset so we only have the variables we would like to use. We gave them more clear names and dropped all rows with NA values.

## Political corruption
```{r}
  ggplot(data = democracy_effect) +
  geom_histogram(mapping = aes(x = political_corr), binwidth = 0.05)
```

We can see there are more countries in the data set with a higher political corruption index. We can also see that there is a little concentration in the middle with countries that score about average on the political corruption scale.


## Liberal democracy
```{r}
  ggplot(data = democracy_effect) +
  geom_histogram(mapping = aes(x = liberal_democracy), binwidth = 0.02)
```

We can see in the histogram for liberal democracy that the higher the value is, the lower the likelihood is for a country to qualify for it.

With a lower binwidth, we are able to more accurately spot a downward thread in the histogram.


## Liberal democracy and political corruption
```{r}
  ggplot(data = democracy_effect) +
  geom_smooth(mapping = aes(x = liberal_democracy, y = political_corr))
```

We can see that there is a negative correlation between political corruption and liberal democracy. This is to be expected, because for a country to score high on the liberal democracy index, that country should score low on political corruption. On of the criteria for a liberal democracy is effective checks and balances, and that is not achieved when there is a high amount of political corruption.

## Equal opportunity
```{r}
  ggplot(data = democracy_effect) +
  geom_bar(mapping = aes(x = equal_oppor))
```

We can see that there is a negative curvilinear relationship between the equal opportunity and the way countries score on it. There are less countries on the low end and high end on the equal opportunity scale as opposed to countries that score between 3 and 7. The highest amount of countries have score of 5.

## Liberal democracy and equal opportunity

```{r}
  ggplot(data = democracy_effect) +
  geom_smooth(mapping = aes(x = liberal_democracy, y = equal_oppor))

```

## Freedom of speech
```{r}
  ggplot(data = democracy_effect) +
  geom_bar(mapping = aes(x = freedom_of_speech))
```

### Zoom in on low score freedom of speech
```{r}
  freedom_low <- democracy_effect %>%
                  filter(freedom_of_speech < 3)

  ggplot(data = freedom_low) +
  geom_bar(mapping = aes(x = freedom_of_speech))
```

It appears that there's no column in the freedom of speech variable that has the value 1. The bar plot for freedom of speech has a low number of countries with a score lower than 2.



## Freedom of speech and liberal democracy
```{r}
  ggplot(data = democracy_effect) +
  geom_point(mapping = aes(x = liberal_democracy, y = freedom_of_speech)) 
```

Although the relationship is not too strong, we can see that there is a positive correlation between liberal democracy and freedom of speech. This lines up with our expectations, because for a country to score high on the liberal democracy index, they have to protect civil liberties. A country with a lower score should also score lower on freedom of speech.




```{r}
  ggplot(data = democracy_effect, mapping = aes(x = liberal_democracy, y = freedom_of_speech)) +
  geom_point() +
  geom_smooth(method = lm, color ="red", se=FALSE)


```



```{r}
  lmspeech <- lm(liberal_democracy ~ freedom_of_speech, data = democracy_effect)

summary(lmspeech)
```

## Mohamed Ismael liberal democracy & freedom of speech

## Mohamed Elgendy liberal democracy & equal opportunity



