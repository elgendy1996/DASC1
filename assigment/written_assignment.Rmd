---
title: "written_assignment"
author: "Mohamed Ismael, Mohamed Elgendy"
date: "2022-09-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
  library(tidyverse)
```
# Import
```{r}
  qog_std <- read.csv("dataset/qog_std_cs_jan22.csv")



qog_std %>% drop_na()
```
```{r}
 qog_std$oecd_c
```
# Tidy

## Friendly variable names
Basic Human Needs (SPI) (spi_bn)
Human Capital Index (egov_hci)
COVID
Political Rights (fh_pr)
Paid Bribe: Police (gcb_bpol)
Total bribery rate, total population (gcb_br)
Accountability and Transparency (iiag_acc)
Anti-corruption (iiag_corr)
Number of previous democratic breakdowns (bmr_dembr)
Number of COVID-19 cases reported (jht_ccc) 436
Number of COVID-19 deaths reported (jht_ccd)
Life Expectancy, Both sexes, Age 1-4 years (ihme_lifexp_0104t)
Total fertility rates (oecd_fertility_t1)
Health (iiag_he)
Road fatalities (oecd_rddeath_t1)
Adult population smoking daily (oecd_smoke_g1)
Alcohol consumption per capita (in litres) (who_alcohol10)
Suicide Rate (per 100,000 population), Total (who_suit)
Employment rate total 15-64 (eu_empy1564t)
Youths not in education or employment 15-19 (oecd_socexclus_t1a)
Youths not in education or employment 20-24 (oecd_socexclus_t1b)
liberal democracy index (vdem_libdem)
Satisfaction with your life (wvs_satlif)
Freedom of Expression and Belief (fh_feb)
Type of Government (cpds_tg)
Institution (gol_inst) 
Top 10% income share (top_top10_income_share)
Top 1% income share (top_top1_income_share)
 Extent of market dominance. 1-7 (best) (wef_md)
 Burden of government regulation. 1-7 (best) (wef_bgr)
Cultural Diversity (fe_cultdiv)
Population growth rates (oecd_evopop_g1)
Employment rates: total (oecd_emplgndr_t1c)
Employment rates for age group 15-24 (oecd_emplage_t1a)
Perception of Electoral Integrity Index Type (pei_peit)
Institution (gol_inst)


# Main question : How has COVID-19 effected education and mental health? (suicide rate, alcohol consumptions)


```{r}
democracy_effect <- qog_std %>%
  select(
    vdem_libdem,
    vdem_corr,
    bti_eo,
    oecd_evogdp_t1,
    fh_feb,
    vdem_mecorrpt,
  )%>%
  rename(
    liberal_democracy = vdem_libdem,
    political_corr = vdem_corr,
    equal_oppor = bti_eo,
    gdp_growth =oecd_evogdp_t1,
    freedom_of_speech = fh_feb,
    media_corrupt = vdem_mecorrpt,
  ) %>% drop_na(liberal_democracy, 
                political_corr, 
                equal_oppor, 
                freedom_of_speech, 
                media_corrupt
  )
    

democracy_effect
```
Every plot should have a title
```{r}
  ggplot(data = democracy_effect) +
  geom_smooth(mapping = aes(x = liberal_democracy, y = political_corr))
```






```{r}
  ggplot(data = democracy_effect) +
  geom_smooth(mapping = aes(x = liberal_democracy, y = equal_oppor))

```
```{r}
  ggplot(data = democracy_effect) +
  geom_point(mapping = aes(x = liberal_democracy, y = freedom_of_speech)) 


```
```{r}
  ggplot(data = democracy_effect) +
  geom_point(mapping = aes(x = liberal_democracy, y = freedom_of_speech, color = election_integrity)) 


```


# media corrupt

```{r}

  ggplot(data = democracy_effect) +
  geom_point(mapping = aes(x = liberal_democracy, y = media_corrupt))

```
Despite freedom of speech being higher in liberal democracies, we see that media corruption is also higher.
We think might be because there are large companies that want to influence voters to align with their interests.If a large company sees that certain political parties want to implement rules that might damage their revenue, they might
use the media to steer the conversation in their favor in order to make those rules unpopular to implement.

```{r}

  ggplot(data = democracy_effect) +
  geom_bar(mapping = aes(x = institution))
```


##unexpected outcome after researching it turns out that newly trasitioned countriecies the more corruption it will have

```{r}
  ggplot(data = democracy_effect) +
  geom_smooth(mapping = aes(x = liberal_democracy, y = accepting_bribe))


```
```{r}
  ggplot(data = democracy_effect) +
  geom_smooth(mapping = aes(x = liberal_democracy, y = embezzlement))

```
```{r}
  ggplot(data = democracy_effect, mapping = aes(x = liberal_democracy, y = freedom_of_speech)) +
  geom_point() +
  geom_smooth(method = lm, color ="red", se=FALSE)


```
## Rule of law and justice
```{r}
  ggplot(data = democracy_effect) +
  geom_smooth(mapping = aes(x = liberal_democracy, y = rule_of_law))

```
```{r}
  ggplot(data = democracy_effect) +
  geom_point(mapping = aes(x = liberal_democracy, y = civil_rights))
```


```{r}
  ggplot(data = democracy_effect) +
  geom_smooth(mapping = aes(x = liberal_democracy, y = relig_importance))
```


